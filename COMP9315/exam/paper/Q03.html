<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>COMP9315 22T1 Final Exam </title>
<link rel='stylesheet' type='text/css' href='exam.css'></head>
<body>
<div align='center'>
<table width='100%' border='0'>
<tr valign='top'>
<td align='left' width='20%'>
  <span class='tiny'>COMP9315 22T1 Final Exam</span>
</td>
<td align='center' width='60%'>
  The University of New South Wales <br>
  <span class='heading'>COMP9315 DBMS Implementation <br>  22T1 Final Exam</span>
</td>
<td align='right' width='20%'>
  <span class='tiny'>DBMS Implementation</span>
</td>
</table>
</div>
<center><a href='index.html'>[Instructions]</a> <a target='PostgreSQL' href='https://www.postgresql.org/docs/12/index.html'>[PostgreSQL]</a> <a target='C' href='c-lang/index.html'>[C]</a> <a target='Q1-3 Info' href='q1-3/index.html'>[Q1-3 Info]</a> 
<br>
<a href='Q01.html'>[Q1]</a> <a href='Q02.html'>[Q2]</a> <b>[Q3]</b> <a href='Q04.html'>[Q4]</a> <a href='Q05.html'>[Q5]</a> <a href='Q06.html'>[Q6]</a> <a href='Q07.html'>[Q7]</a> <a href='Q08.html'>[Q8]</a> 
</center>
<hr>
<div style='margin-left:40px;margin-right:40px'>
<h3>Question 3 <span class='tiny'>(25 marks)</span></h3>
<p>
The <tt>q3</tt> directory contains an incomplete program <tt>q3.c</tt>.
You must complete this program so that it reads tuples from a file and
inserts them into newly-created "no-frills" data file
(see <a target='Q1-3 Info' href="q1-3/index.html">[Q1-3 Info]</a>
for details on what a "no-frills" data file is).
The program takes two command-line arguments: the first
is the name of the "no-frills" data file to be created,
the second is the name of the file containing the tuples, e.g.
<pre>
$ <b>./q3 myData data/input200</b>
</pre>
<p>
Insert each tuple into a page buffer, which is initially all zeroes.
Tuples are inserted directly one after another, where the next tuple
occurs immediately after the <tt>'\0'</tt> that terminates the previous
tuple.
When there is insufficient space to add the next tuple, write out the
page buffer, clear it, and start inserting tuples into it.
Note that the last tuple in a page should be followed by a <tt>'\0'</tt>
character, which follows immediately after the tuple's own terminating
<tt>'\0'</tt> character.
<p>
If the tuples file is empty, you must write a data page
containing no tuples; you cannot leave the file totally
empty (i.e. it must have at least PAGESIZE bytes).
</p>
<p>
The command-line argument processing is already handled in <tt>q3.c</tt>.
By the time it reaches the code you need to write, you will have a
valid file descriptor for the "no-frills" data file and a valid file
pointer for the tuple file.
There are examples of using <tt>./q3</tt> in the <tt>tests</tt>
directory.
You should also be able to devise your own test cases easily
enough.
</p>
<p>
Note that you need to maintain the tuple count in each page as
you add tuples.
The data file you build should be able to be examined by the
<tt>q1</tt> command and return the correct number of tuples.
</p>
<p>
To help you check whether your program is working correctly,
there is a script called <tt>run_tests.sh</tt> which will run
the program against the test cases in the <tt>tests</tt> directory
and report the results.
It will also put the data file created by your program in the
current directory (i.e. your <tt>q3</tt> directory).
The example <tt>data/inputX</tt> files create the <tt>data/DataY</tt>
files in the <tt>data</tt> directory.
The testing script then compares the created data file against the
relevant data file and reports whether it matches this file.
If the created data file is not identical to the actual data file,
then the script reports a failure.
</p>
<p>
You can examine the test cases by looking at the <tt>tests/*.sh</tt>
files.
You can run the testing script as:
</p>
<pre>
$ <b>sh run_tests.sh</b>
</pre>
<p>
Once your function is working (passes all tests), follow
the submission instructions below.
Even if it fails some (or even all) tests, you should submit because
you can get <i>some</i> marks.
If your program does not compile, or if you simply submit
the supplied code, then your "answer" is worth zero marks.
</p>
<p><b>Submission Instructions:</b></p>
<ul>
<li> Type your answer to this question into the file called <tt>q3.c</tt>
<li> Submit via: &nbsp; <b><tt>give cs9315 exam_q3 q3.c</tt></b> <br>
	or via: Webcms3 &gt; exams &gt; Final Exam &gt; Q<nobr>3</nobr> submission &gt; Make Submission
</ul>

</div>
<center><i>End of Question</i></center>
</body>
</html>
